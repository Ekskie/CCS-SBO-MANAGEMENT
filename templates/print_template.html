<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LSPU - List of Organization Members</title>
    <link rel="stylesheet" href="style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Times+New+Roman&display=swap" rel="stylesheet">
</head>

<body>

    <button id="printButton"
        style="position: fixed; top: 20px; right: 20px; padding: 10px 20px; background-color: #007bff; color: white; border: none; border-radius: 5px; cursor: pointer; font-family: 'Times New Roman', Times, serif;">Print
        Document</button>

    <div class="container">
        <header>
            <img src="/static/image/lspu.png" alt="LSPU Logo">

            <div class="header-text">
                <p>Republic of the Philippines</p>
                <p><span>Laguna State Polytechnic University</span></p>
                <p>Province of Laguna</p>
            </div>
        </header>

        <div class="title-section">
            <h2>OFFICE OF STUDENT AFFAIRS AND SERVICES</h2>
            <p style="font-size: 10pt;"></p>
            <h3>LIST OF MEMBERS OF THE ORGANIZATION</h3>
            <p><b>1st Sem. / AY 2025-2026</b></p>
        </div>

        <div class="org-name-section">
            <label><b style="font-size: 12pt;">Name of Organization</b> <u style="font-size: 10pt;">COLLEGE OF COMPUTER
                    STUDIES – STUDENT BODY ORGANIZATION</u></label>
        </div>

        <div class="sample-format">
            <p class="spHeader">SAMPLE FORMAT:</p>
            <div class="format-card">
                <div class="picture-placeholder small">1 x 1 <br> PICTURE</div>
                <div class="format-details">
                    <p class="sample-line">(Signature Over Printed Name)</p>
                    <p class="sample-line">(Student Number)</p>
                    <p class="sample-line">(Course / Year Section)</p>
                </div>
            </div>
        </div>

        <main class="member-grid">
            {% for member in members %}
            <div class="member-card">
                <div class="picture-placeholder">
                    <img src="{{ member.picture_url or '/image/ako.jpg' }}" alt="Student Photo">
                </div>
                <div>
                    <img class="Student-signature"
                        src="{{ member.signature_url or '/image/308771144_1137264036926002_4677600179940207278_n.jpg' }}"
                        alt=""
                        style="width: 100px; position: absolute; transform: translate(40px, -55px); mix-blend-mode:darken; aspect-ratio: 1/1;">
                    <input type="text" class="member-name" value="{{ member.full_name }}">
                    <input type="text" class="member-info" value="{{ member.student_id }}">
                    <input type="text" class="member-info" value="{{ member.course }}">
                </div>
            </div>
            {% endfor %}
        </main>

        <footer>
            <div class="advisers">
                <div class="adviser-col">
                    <p class="signature-name">MERVIN JOMMEL T. DE JESUS</p>
                    <p class="signature-title">Organization Adviser</p>
                    <p class="signature-date">Date: <span class="fill-in-date">September 25, 2025</span></p>
                </div>
                <div class="adviser-col">
                    <p class="signature-name">LOUIE JEROME L. ROLDAN</p>
                    <p class="signature-title">Organization Adviser</p>
                    <p class="signature-date">Date: <span class="fill-in-date">September 25, 2025</span></p>
                </div>
            </div>

            <div class="approvals">
                <div class="approval-block">
                    <p></p>
                    <p class="approval-label dean">Noted:</p>
                    <p class="signature-name no-border dean">FRANCIS F. BALAHADIA, DIT</p>
                    <p class="signature-title dean">Dean/Assoc. Dean of College</p>
                </div>
                <div class="approval-block">
                    <p></p>
                    <p class="approval-label">Recommending Approval:</p>
                    <p class="signature-name no-border">NIÑO EMMANUEL ALDI L. ASTOVEZA</p>
                    <p class="signature-title">Head, Student Organization and Activities Unit</p>
                </div>

                <div class="approval-block">
                    <p></p>
                    <p class="approval-label">Approved / Disapproved:</p>
                    <p class="signature-name no-border">JEANFEL J. CASIÑO</p>
                    <p class="signature-title">Director/Chairperson, Office of Student Affairs and Services</p>
                </div>
            </div>
            <div class="doc-info">
                <p>LSPU-OSAS-SF-005 </p>
                <p>Rev. 1</p>
                <p>09 November 2020</p>
            </div>
        </footer>
    </div>

    <script>
        document.getElementById('printButton').addEventListener('click', function () {
            window.print();
        });

        // Hide the print button when printing
        const style = document.createElement('style');
        style.textContent = '@media print { #printButton { display: none; } }';
        document.head.appendChild(style);

        // Add student functionality
        document.getElementById('add-btn').addEventListener('click', function () {
            const name = document.getElementById('new-name').value.trim();
            const id = document.getElementById('new-id').value.trim();
            const section = document.getElementById('new-section').value.trim();

            if (!name || !id || !section) {
                alert('Please fill in all fields.');
                return;
            }

            // Find all member-name inputs
            const nameInputs = document.querySelectorAll('.member-name');
            let emptyIndex = -1;
            for (let i = 0; i < nameInputs.length; i++) {
                if (nameInputs[i].value.trim() === '') {
                    emptyIndex = i;
                    break;
                }
            }

            if (emptyIndex !== -1) {
                // Fill the empty slot
                nameInputs[emptyIndex].value = name;
                const card = nameInputs[emptyIndex].closest('.member-card');
                const infoInputs = card.querySelectorAll('.member-info');
                infoInputs[0].value = id;
                infoInputs[1].value = section;
            } else {
                // Clone the last container and append
                const containers = document.querySelectorAll('.container');
                const lastContainer = containers[containers.length - 1];
                const newContainer = lastContainer.cloneNode(true);
                // Clear the member inputs in the new container
                const newNameInputs = newContainer.querySelectorAll('.member-name');
                const newInfoInputs = newContainer.querySelectorAll('.member-info');
                newNameInputs.forEach(input => input.value = '');
                newInfoInputs.forEach(input => input.value = '');
                // Fill the first card
                newNameInputs[0].value = name;
                const firstCard = newNameInputs[0].closest('.member-card');
                const firstInfoInputs = firstCard.querySelectorAll('.member-info');
                firstInfoInputs[0].value = id;
                firstInfoInputs[1].value = section;
                // Append after the last container
                lastContainer.parentNode.insertBefore(newContainer, lastContainer.nextSibling);
            }

            // Clear the form
            document.getElementById('new-name').value = '';
            document.getElementById('new-id').value = '';
            document.getElementById('new-section').value = '';
        });
        document.addEventListener("DOMContentLoaded", function () {
            const inputs = document.querySelectorAll('.member-name');

            inputs.forEach(input => {
                fitTextToInput(input);

                // Recheck size if text changes dynamically
                input.addEventListener('input', () => fitTextToInput(input));
            });

            function fitTextToInput(input) {
                const maxFontSize = 11; // base font size (pt)
                const minFontSize = 6;  // smallest allowed font
                const testSpan = document.createElement('span');
                testSpan.style.visibility = 'hidden';
                testSpan.style.whiteSpace = 'nowrap';
                testSpan.style.position = 'absolute';
                testSpan.style.fontFamily = window.getComputedStyle(input).fontFamily;
                document.body.appendChild(testSpan);

                let fontSize = maxFontSize;
                testSpan.style.fontSize = fontSize + 'pt';
                testSpan.textContent = input.value;

                while (testSpan.offsetWidth > input.offsetWidth - 5 && fontSize > minFontSize) {
                    fontSize -= 0.5;
                    testSpan.style.fontSize = fontSize + 'pt';
                }

                input.style.fontSize = fontSize + 'pt';
                document.body.removeChild(testSpan);
            }
        });
    </script>
</body>

</html>